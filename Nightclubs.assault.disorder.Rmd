---
title: "Night clubs, assault, and disorderly conduct"
author: "Erica Turner"
date: "4/25/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE)
library(tidyverse)
library(sf) 
library(knitr) 
```

## Load data

add

```{r load data and subset}
arrests <-read.csv("/Users/Erica/Desktop/Data-Science/final.project/datasets/Adult_Arrests.csv")
liquor <-read.csv("/Users/Erica/Desktop/Data-Science/final.project/datasets/Liquor_Licenses.csv")
nightclubs <-read.csv("/Users/Erica/Desktop/Data-Science/final.project/datasets/Night_clubs.csv")

```

## Subset arrests 

Narrow down arrests to for simple assuault and disorderly conduct, occuring in 2017, between the hours of 9pm and 4am, and those not missing data for longitude or latitude. 

Narrow down types of disorderly conduct to those likely to happen as a result of intoxication (e.g. eliminate leash law violations)


```{r subset, echo=FALSE, results="hide"}
unique(arrests$CATEGORY)

arrests2 <- arrests %>%
  subset(YEAR > 2016) %>%
  subset(CATEGORY == "Simple Assault" | CATEGORY == "Disorderly Conduct")
  
arrests2[!is.na(arrests2$OFFENSE_LONGITUDE),]
arrests2[!is.na(arrests2$OFFENSE_LATITUDE),]

#Unique values of Disorderly Conduct to eliminate those not likely related to alcohol  
arrests3 <- subset(arrests2, CATEGORY == "Disorderly Conduct")
unique(arrests3$DESCRIPTION)

arrests4 <- arrests2 %>%
  subset(DESCRIPTION != "Animals - Other Than Dogs At Large "  | 
           DESCRIPTION != "Illegal Dumping" |
           DESCRIPTION != "Dogs - Vacci tion Required " |
           DESCRIPTION != "Dogs - At Large" |
           DESCRIPTION != "Crossing Police Line" |
           DESCRIPTION != "Dogs - Unleashed"   |
           DESCRIPTION != "Wearing Hood Or Mask ---  (a) No Person Or Persons Over 16 Years Of
           Age, While Wearing Any Mask, Hood, Or Device Whereby Any Po" |
           DESCRIPTION != "Crowding, Obstructing, or Incommoding (M)"  |
           DESCRIPTION != "Panhandling"  |
           DESCRIPTION != "Aggressive Panhandling" |
           DESCRIPTION != "Dog Regulations - Unleashed Dog " |
           DESCRIPTION != "Blocking Passage" |
           DESCRIPTION != "Metro - Fail To Pay Fare" |
           DESCRIPTION != "Disorderly Conduct In A Public Building" |
           DESCRIPTION != "Panhandling - Aggressive" |
           DESCRIPTION != "Panhandling - Private Property" |
            DESCRIPTION != "Dogs - Disturbing The Peace" |
            DESCRIPTION != "Dog - Dangerous Dog Attack Or Bite" |
            DESCRIPTION != "Attending Or Kindling Bonfires " )

arrests5 <- arrests4 %>%
  subset(HOUR == 21:23 |
           HOUR == 0:4) 

arrests <- arrests5
rm(arrests2, arrests3, arrests4, arrests5)
```

## Subset liquor licenses

```{r liquor, results="hide"}

unique(liquor$STATUS)
liquor <- subset(liquor, STATUS == "Active" |
                   STATUS == "Issued")

unique(liquor$TYPE)
liquor2<- liquor %>%
  subset(TYPE == "Club"  |
           TYPE == "Nightclub"  |
           TYPE == "Tavern"  |
           TYPE == "Arena")
           
liquor2[!is.na(liquor2$LONGITUDE),]
liquor2[!is.na(liquor2$LATITUDE),]  

liquor <- liquor2
rm(liquor2)
```

## Plot arrests and bar locations 

```{r plotting}
library(sf) 
library(dplyr)
library(httr)
library(gridExtra)

hoods<- st_read("/Users/Erica/Desktop/Data-Science/final.project/datasets/Neighborhood_Clusters/Neighborhood_Clusters.shp")

grid.arrange(
ggplot(data=hoods) + geom_sf(aes(fill=Shape_Area)) +
theme_void() + labs(title="title"))


#? hoods.arrests <- left_join(hoods, arrests, by = "OBJECTID")

plot <- ggplot(data=hoods) + geom_sf(aes(fill=NULL)) + labs(title="Arrests for simple assault\nand disorderly conduct\n+ bar locations (2018)") 

plot + geom_point(data=arrests, aes(x=OFFENSE_LONGITUDE, y=OFFENSE_LATITUDE), size = .5, alpha= .5, color="red") +
  geom_point(data=liquor, aes(x=LONGITUDE, y=LATITUDE), size = .5, alpha= .5, color="blue")



```


```{r autocorelation}

```

